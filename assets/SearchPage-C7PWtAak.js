import{a as P,r as s,j as e,s as N}from"./index-7uJ0qKqD.js";import{M as b}from"./MovieGrid-DoFVm-rM.js";import{M as S}from"./MovieGridSkeleton-DW-WaVP_.js";import{P as y}from"./Pagination-BK7uePpH.js";import"./useWatchLater-B27ka-37.js";import"./MovieCardSkeleton--xuy0sGE.js";const n=30,C=()=>{const[c,p]=P(),t=c.get("q")||"",a=parseInt(c.get("page")||"1",10),[i,l]=s.useState([]),[m,d]=s.useState(0),[u,r]=s.useState(!0);s.useEffect(()=>{if(!t){l([]),d(0),r(!1);return}(async()=>{r(!0);const f=(a-1)*n,v=f+n-1;try{const{data:o,error:g,count:M}=await N.from("movies").select("*",{count:"exact"}).ilike("title",`%${t}%`).order("created_at",{ascending:!1}).range(f,v);if(g)throw g;l(o),d(M||0)}catch(o){console.error("Error fetching movies for search page:",o)}finally{r(!1)}})(),window.scrollTo(0,0)},[t,a]);const j=h=>{p({q:t,page:h.toString()})},x=Math.ceil(m/n);return u?e.jsxs("div",{className:"animate-fade-in",children:[e.jsxs("h1",{className:"text-3xl font-bold text-white mb-8",children:['جاري البحث عن "',e.jsx("span",{className:"text-cyan-400",children:t}),'"']}),e.jsx(S,{count:12})]}):e.jsxs("div",{className:"animate-fade-in",children:[e.jsxs("h1",{className:"text-3xl font-bold text-white mb-8 border-r-4 border-cyan-400 pr-4",children:['نتائج البحث عن "',e.jsx("span",{className:"text-cyan-400",children:t}),'"',e.jsxs("span",{className:"text-lg font-normal text-slate-400 mr-2",children:["(",m," نتيجة)"]})]}),i.length>0?e.jsxs(e.Fragment,{children:[e.jsx(b,{movies:i}),x>1&&e.jsx(y,{currentPage:a,totalPages:x,onPageChange:j})]}):e.jsxs("div",{className:"text-center p-12 bg-slate-800/50 rounded-lg mt-8",children:[e.jsx("p",{className:"text-2xl text-slate-300 mb-4",children:"لا توجد أفلام تطابق بحثك."}),e.jsx("p",{className:"text-slate-400",children:"حاول استخدام كلمات رئيسية مختلفة."})]})]})};export{C as default};
