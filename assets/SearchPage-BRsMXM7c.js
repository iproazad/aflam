import{a as h,r as n,f as x,j as e,s as u}from"./index-HeU7K3wb.js";import{M as g}from"./MovieGrid-B8veR35L.js";import{M as p}from"./MovieGridSkeleton-BhBGbX7B.js";import"./useWatchLater-CZ2cKbYA.js";import"./MovieCardSkeleton-DhA1VA27.js";const v=async()=>{let o=[],t=0;const l=1e3;for(;;){const{data:s,error:a}=await u.from("movies").select("*").order("created_at",{ascending:!1}).range(t,t+l-1);if(a)throw console.error("Error fetching all movies for search:",a),a;if(s&&s.length>0){if(o=o.concat(s),s.length<l)break;t+=s.length}else break}return o},S=()=>{const[o]=h(),t=o.get("q")||"",[l,s]=n.useState([]),[a,d]=n.useState([]),[c,m]=n.useState(!0);return n.useEffect(()=>{(async()=>{m(!0);try{const r=await v();s(r)}catch(r){console.error("Error fetching movies for search page:",r)}finally{m(!1)}})()},[]),n.useEffect(()=>{if(!c&&t){const i=l.filter(r=>x(t,r.title));i.sort((r,f)=>new Date(f.created_at).getTime()-new Date(r.created_at).getTime()),d(i)}else d([]);window.scrollTo(0,0)},[t,l,c]),c?e.jsxs("div",{className:"animate-fade-in",children:[e.jsxs("h1",{className:"text-3xl font-bold text-white mb-8",children:['جاري البحث عن "',e.jsx("span",{className:"text-cyan-400",children:t}),'"']}),e.jsx(p,{count:12})]}):e.jsxs("div",{className:"animate-fade-in",children:[e.jsxs("h1",{className:"text-3xl font-bold text-white mb-8 border-r-4 border-cyan-400 pr-4",children:['نتائج البحث عن "',e.jsx("span",{className:"text-cyan-400",children:t}),'"',e.jsxs("span",{className:"text-lg font-normal text-slate-400 mr-2",children:["(",a.length," نتيجة)"]})]}),a.length>0?e.jsx(g,{movies:a}):e.jsxs("div",{className:"text-center p-12 bg-slate-800/50 rounded-lg mt-8",children:[e.jsx("p",{className:"text-2xl text-slate-300 mb-4",children:"لا توجد أفلام تطابق بحثك."}),e.jsx("p",{className:"text-slate-400",children:"حاول استخدام كلمات رئيسية مختلفة."})]})]})};export{S as default};
