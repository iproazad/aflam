import{r as o,u as b,d,F as g,j as c}from"./index-Cwg1nzsq.js";const v=s=>{const[a,i]=o.useState(void 0),[l,u]=o.useState(!1),t=o.useRef(null);return o.useEffect(()=>{let e;const r=t.current;return r&&!a&&(e=new IntersectionObserver(([f])=>{f.isIntersecting&&(i(s),e.unobserve(f.target))},{rootMargin:"0px 0px 200px 0px"}),e.observe(r)),()=>{e&&r&&e.unobserve(r)}},[s,a]),{imageRef:t,imageSrc:a,isLoaded:l,handleImageLoad:()=>{u(!0)}}},h=()=>{const{currentUser:s}=b(),[a,i]=o.useState([]);o.useEffect(()=>{if(!s){i([]);return}const n=d.collection("user_lists").doc(s.uid).onSnapshot(e=>{if(e.exists){const r=e.data();i((r==null?void 0:r.favorites)||[])}else i([])},e=>{console.error("Error listening to favorites:",e)});return()=>n()},[s]);const l=o.useCallback(async t=>{if(!s){console.warn("User must be logged in to manage favorites.");return}const n=d.collection("user_lists").doc(s.uid),e=a.includes(t);try{e?await n.update({favorites:g.arrayRemove(t)}):await n.set({favorites:g.arrayUnion(t)},{merge:!0})}catch(r){console.error("Error toggling favorite in Firestore:",r)}},[s,a]),u=o.useCallback(t=>a.includes(t),[a]);return{favorites:a,toggleFavorite:l,isFavorite:u}},w=()=>{const{currentUser:s}=b(),[a,i]=o.useState([]);o.useEffect(()=>{if(!s){i([]);return}const n=d.collection("user_lists").doc(s.uid).onSnapshot(e=>{if(e.exists){const r=e.data();i((r==null?void 0:r.watchLater)||[])}else i([])},e=>{console.error("Error listening to watch later list:",e)});return()=>n()},[s]);const l=o.useCallback(async t=>{if(!s){console.warn("User must be logged in to manage watch later list.");return}const n=d.collection("user_lists").doc(s.uid),e=a.includes(t);try{e?await n.update({watchLater:g.arrayRemove(t)}):await n.set({watchLater:g.arrayUnion(t)},{merge:!0})}catch(r){console.error("Error toggling watch later in Firestore:",r)}},[s,a]),u=o.useCallback(t=>a.includes(t),[a]);return{watchLater:a,toggleWatchLater:l,isWatchLater:u}},L=()=>c.jsxs("div",{className:"block group relative rounded-lg overflow-hidden shadow-lg bg-gray-800 animate-pulse",children:[c.jsx("div",{className:"relative w-full aspect-[2/3] bg-gray-700"}),c.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent"}),c.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-2 sm:p-3 md:p-4",children:[c.jsx("div",{className:"h-5 bg-gray-600 rounded w-3/4 mb-2"}),c.jsxs("div",{className:"flex justify-between items-center mt-1",children:[c.jsx("div",{className:"h-4 bg-gray-600 rounded w-1/4"}),c.jsx("div",{className:"h-4 bg-gray-600 rounded w-1/4"})]})]})]});export{L as M,w as a,v as b,h as u};
